(function(){var a='<div class="ms-matrix-logo"></div><div class="ms-matrix-contents"></div><div class="ms-matrix-menu"><div class="ms-matrix-menu-button"><span class="ms-matrix-menu-text">Menu</span></div></div>';function e(h){h=h||{};this.headerElement=this.createOrInitializeHeaderElement(h.container);this.titleOrElement=h.contents;this.menuShown=false;this.useNativeMenuButton=h.useNativeMenuButton;this.menuButton=null;this.contentContainer=null;this.listeners={};this.initialize()}e.prototype={createOrInitializeHeaderElement:function(h){var i=h||document.createElement("div");i.className+=" ms-matrix-header-bar";i.innerHTML=a;return i},initialize:function(){this.contentContainer=this.findContentElement(this.headerElement);this.menuButton=this.findMenuButton(this.headerElement);this.setContent(this.titleOrElement);this.bindMenuButtonTapHandler(this.headerElement);this.updateMenuPresence(this.headerElement)},getElement:function(){return this.headerElement},updateMenuPresence:function(h){if(this.useNativeMenuButton===true){var i=this.findMenuButton(h);i.style.display="none";if(window.MatrixPortal){window.MatrixPortal.showMenuButton()}else{document.addEventListener("deviceready",function(){window.MatrixPortal.showMenuButton()})}}},findContentElement:function(h){return h.childNodes[1]},findMenuButton:function(h){var i=h.childNodes[2];return i.firstChild},setContent:function(h){if(h instanceof HTMLElement){this.setContentElement(h)}else{if(typeof h==="string"){this.setTitle(h)}else{console.log("MsMatrixHeaderBar.setContent: cannot insert specified content, only an HTMLElement or a String is supported - "+h)}}},setContentElement:function(h){this.removeContent();this.contentContainer.appendChild(h)},removeContent:function(){if(this.contentContainer.firstChild!==null){this.contentContainer.removeChild(this.contentContainer.firstChild)}this.contentContainer.className=this.contentContainer.className.replace(/ ms-matrix-title/,"")},setTitle:function(h){this.setContentElement(document.createTextNode(h));this.contentContainer.className+=" ms-matrix-title"},bindMenuButtonTapHandler:function(h){this.menuButton.addEventListener("touchstart",this.bind(this.stopClickEventOnTouchEnabledDevice),false);var i=this.bind(this.toggleMenu);if(window.MatrixPortal){window.MatrixPortal.toggleMenuFn=i}else{document.addEventListener("deviceready",function(){window.MatrixPortal.toggleMenuFn=i})}this.menuButton.addEventListener("touchend",i,false);this.menuButton.addEventListener("click",i,false)},bind:function(i){var h=this;return function(){i.apply(h,arguments)}},stopClickEventOnTouchEnabledDevice:function(h){h.stopPropagation();h.preventDefault()},toggleMenu:function(){var i=document.getElementsByClassName("ms-matrix-menu-button");if(i.length===0){if(menu.className==="matrix-menu-button"){window.MatrixPortal.showMenu();menu.className="matrix-menu-button show"}else{menu.className="matrix-menu-button";window.MatrixPortal.hideMenu()}}else{var h=i[0];if(h.className.indexOf(" ms-shown")!==-1){window.MatrixPortal.hideMenu();h.className=h.className.replace(/ ms-shown/,"")}else{window.MatrixPortal.showMenu();h.className+=" ms-shown"}}}};var d="ms-matrix-mobile-app-header-bar";function g(){if(window.Ext){if(Ext.define){return c()}else{return b()}}}var f={renderHeaderBar:function(){this.headerBar=new e({container:this.getContainerDom(),useNativeMenuButton:this.useNativeMenuButton});return;new Ext.Container({items:[{xtype:"button",text:"Hi There"}],renderTo:this.headerBar.contentContainer})},setTitle:function(h){this.destroyComponent();this.headerBar.setTitle(h)},removeAll:function(){this.destroyComponent();this.headerBar.removeContent()},getComponent:function(){return this.component},setComponent:function(h){this.removeAll();if(h.render){h.render(this.headerBar.contentContainer)}else{this.headerBar.setContent(h.element.dom)}this.component=h},destroyComponent:function(){if(this.component){this.component.destroy();this.component=null}}};function b(){Ext.namespace("matrix.mobile.app.st1");matrix.mobile.app.st1.HeaderBar=Ext.extend(Ext.Container,Ext.apply({dock:"top",height:48,useNativeMenuButton:true,constructor:function(h){if(h&&h.useNativeMenuButton!==undefined){this.useNativeMenuButton=h.useNativeMenuButton}this.headerBar=null;this.component=null;this.config=h;matrix.mobile.app.st1.HeaderBar.superclass.constructor.call(this,arguments);this.on("afterrender",this.renderHeaderBar,this)},getContainerDom:function(){return this.getEl().dom}},f));Ext.ComponentMgr.registerType(d,matrix.mobile.app.st1.HeaderBar);return matrix.mobile.app.st1.HeaderBar}function c(){return Ext.define("matrix.mobile.app.st2.HeaderBar",Ext.apply({extend:"Ext.Container",xtype:d,config:{docked:"top",height:48,useNativeMenuButton:true},constructor:function(h){this.useNativeMenuButton=(h&&h.useNativeMenuButton!==undefined)?h.useNativeMenuButton:this.config.useNativeMenuButton;this.headerBar=null;this.component=null;this.config=h;this.on("initialize",this.renderHeaderBar,this);this.callParent(arguments)},getContainerDom:function(){return this.element.child("div").dom}},f))}window.createMsMatrixHeaderBar=function(h,i){return new e({contents:h,useNativeMenuButton:(i!==undefined?i:true)})};if(window.jasmine){b();c();window.createSenchaTouchClassDefinition=g}else{g()}})();(function(){var a=null;var c=null;window.onload=function(){a=createMsMatrixHeaderBar(b("apptitle"));document.body.appendChild(a.getElement());document.body.appendChild(d())};function d(){var e=document.createElement("iframe");e.id="container_iframe";e.src=b("appurl");e.allowfullscreen=true;e.scrolling="no";e.sandbox="allow-same-origin allow-scripts allow-forms";e.style.position="fixed";e.style.margin=0;e.style.padding=0;e.overflow="hidden";e.style.border="none";e.seamless="seamless";e.width=document.documentElement.clientWidth;e.height=document.documentElement.clientHeight-a.getElement().offsetHeight;return e}function b(e){var g=window.parent?window.parent.location.search:window.location.search;e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var h=new RegExp("[\\?&]"+e+"=([^&#]*)"),f=h.exec(g);return f==null?"":decodeURIComponent(f[1].replace(/\+/g," "))}})();